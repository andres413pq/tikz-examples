\documentclass[11pt]{article}% Format article, police 11 par défaut (autres tailles : 10, 12)

\usepackage[T1]{fontenc}
\usepackage[frenchb]{babel}
\usepackage{textcomp}
\usepackage{lmodern}%police lmodern ou pour un meilleur affichage PDF. Autres possibilités: times, palatino, bookman, courier.
\usepackage[latin1]{inputenc}
\usepackage{a4wide}
\usepackage{amssymb,amsmath}
\usepackage{graphicx,xcolor}
\usepackage{tikz}
\usetikzlibrary{decorations,arrows,backgrounds,patterns}
\usetikzlibrary{calc,fadings,decorations.pathreplacing,decorations.text,shapes,snakes}
\usepackage{rotating}
\usepackage[active,pdftex,floats,tightpage]{preview}
%%%>
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{2mm}
%%%>
\usepackage{verbatim}

%Option for nice arrows%
\tikzset{%
  >=latex, %
  inner sep=0pt,%
  outer sep=2pt,%
  mark coordinate/.style={inner sep=0pt,outer sep=0pt,minimum size=3pt,
    fill=black,circle}%
}

%%%% macro for unnumbered caption %%%%
\makeatletter    % <=== in a .sty file delete this
\newcommand{\unnumberedcaption}%
	{\@dblarg{\@unnumberedcaption\@captype}}

\newcommand{\@unnumberedcaption}{}% undefined yet
\long\def\@unnumberedcaption#1[#2]#3{\par
  \addcontentsline{\csname ext@#1\endcsname}{#1}{%
    % orig: \protect\numberline{\csname the#1\endcsname}%
    %{\ignorespaces #2}
    \protect\numberline{}{\ignorespaces #2}%
    }%
  \begingroup
    \@parboxrestore
    \normalsize
    % orig: \@makecaption{\csname fnum@#1\endcsname}%
    %{\ignorespaces #3}\par
    \@makeunnumberedcaption{\ignorespaces #3}\par
  \endgroup}

% redefine \@makeunnumberedcaption (like \@makecaption)
% for your own layout
\newcommand{\@makeunnumberedcaption}[1]{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{#1}%
  \ifdim \wd\@tempboxa >\hsize
    #1\par
  \else
    \global \@minipagefalse
    \hbox to\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}

% for LaTeX 2.09 compatibility, define \above/belowcaptionskip:
\@ifundefined{abovecaptionskip}{%
  \newlength{\abovecaptionskip}%
  \setlength{\abovecaptionskip}{10pt}%
}{}
\@ifundefined{belowcaptionskip}{%
  \newlength{\belowcaptionskip}%
  \setlength{\belowcaptionskip}{0pt}%
}{}
\makeatother    % <=== in a .sty file delete this
%%%% fin macro %%%%

\begin{comment}
:Title:  Dipolar magnetic field
:Tags: 3D; Earth Sciences; Petrography; Physics
:Author: Cyril Langlois
This tikz code sketches the light behavior during its travel in a polarizing petrographic microscope when a birefringent crystal thin section is inserted between the polarizing device.

The goal was to correctly show the vectorial relationships between light electric fields during it travel through the first polaroid, the mineral section and the second polaroid.
\end{comment}

%@@@@@@@@@@%
\begin{document}
%
\begin{figure}[!htbp]
\begin{center}
\begin{tikzpicture}[x={(0.866cm,-0.5cm)}, y={(0.866cm,0.5cm)}, z ={(0cm,1cm)}, scale=1.0]
%
%Frame
\path (0,0,0) coordinate (O);
\draw[thick,->,>=stealth] (O) -- +(0,0,2)node[anchor=south]{z};
\draw[thick,->,>=stealth] (O) -- +(14,0,0)node[anchor=west]{x};
\draw[thick,dashed] (-2,0,0) -- (O);
\draw[thick,->,>=stealth] (O) -- +(0,2.5,0)node[anchor=east]{y};
%
% monochromatic incident light with electric field
\draw[thick,color=blue,opacity=0.7,smooth,variable=\x,samples at={-2,-1.75,...,0}] plot (\x,{cos(1.0*\x r)*sin(2.0*\x r)},{sin(1.0*\x r)*sin(2.0*\x r)});
%
\draw[thick,color=blue,opacity=0.7,smooth,variable=\x,samples at={-2,-1.75,...,0}] plot (\x,{-cos(1.0*\x r)*sin(2.0*\x r)},{-sin(1.0*\x r)*sin(2.0*\x r)});
%
\foreach \x in{-2,-1.75,...,0}{
\draw[color=blue,opacity=0.7,->,>=stealth] (\x,0,0) -- (\x,{cos(1.0*\x r)*sin(2.0*\x r)},{sin(1.0*\x r)*sin(2.0*\x r)});
%
\draw[color=blue,opacity=0.7,->,>=stealth] (\x,0,0) -- (\x,{-cos(1.0*\x r)*sin(2.0*\x r)},{-sin(1.0*\x r)*sin(2.0*\x r)});
}
\filldraw[fill=black!60!white,opacity=0.3] (0,-2,-1.5) -- (0,-2,1.5) -- (0,2,1.5) -- (0,2,-1.5) -- (0,-2,-1.5)node[below,sloped,near end]{Polaroid};%
%
%Direction of polarization
\draw[thick,<->,>=stealth] (0,-1.75,-1) -- (0,-0.75,-1);
% Electric field vectors
\draw[thick,color=blue,smooth,variable=\x,samples at={0,0.25,...,6}] plot (\x,{sin(2*\x r)},0)node[anchor=north]{$\vec{E}$};
%
%Polarized light between polaroid and thin section
\foreach \x in{0,0.25,...,6}
\draw[color=blue,->,>=stealth] (\x,0,0) -- (\x,{sin(2*\x r)},0);
\draw (3,1,1)node[text width=2.5cm,text centered]{Polarized light};
%
%Cristal thin section
\draw[thick] (6,-2,-1.5) -- (6,-2,1.5)node[above, sloped,midway]{Cristal section} -- (6,2,1.5) -- (6,2,-1.5) -- cycle;% First face
\draw[thick] (6,-2,-1.5) -- (6.2,-2,-1.5);
\draw[thick] (6,2,-1.5) -- (6.2,2,-1.5);
\draw[thick] (6,-2,1.5) -- (6.2,-2,1.5);
\draw[thick] (6,2,1.5) -- (6.2,2,1.5);
\draw[thick] (6.2,-2,-1.5) -- (6.2,-2,1.5) -- (6.2,2,1.5) -- (6.2,2,-1.5) -- cycle;% Second face
%
%Optical indices
%
\draw[thick,->,>=stealth,color=red!50!black] (6.1,0,0) -- (6.1,0.26,0.966)node[right]{n'$_{g}$};%indice 1
\draw[thick,dashed,color=red!50!black] (6.1,0,0) -- (6.1,-0.26,-0.966);%indice 1
%
\draw[thick,->,>=stealth,color=green!50!black] (6.1,0,0) -- (6.1,0.644,-0.173)node[right]{n'$_{p}$};% indice 2
\draw[thick,dashed,color=green!50!black] (6.1,0,0) -- (6.1,-0.644,0.173);% indice 2
%
%Rays leaving thin section
%
\draw[thick,color=red!50!black,smooth,variable=\x,samples at={6.2,6.45,...,12}] plot (\x,{0.26*0.26*sin(2*(\x-0.5) r)},{0.966*0.26*sin(2*(\x-0.5) r)});%n'g-oriented ray
%
\draw[thick,color=green!50!black,smooth,variable=\x,samples at={6.2,6.45,...,12}] plot (\x,{0.966*0.966*sin(2*(\x-0.1) r)},{-0.26*0.966*sin(2*(\x-0.1) r)});%n'p-oriented ray
%
\draw (10,1,1)node[text width=2.5cm,text centered]{Polarized and dephased light};
%
\foreach \x in{6.2,6.45,...,12}
\draw[color=green!50!black,->,>=stealth] (\x,0,0) -- (\x,{0.966*0.966*sin(2*(\x-0.1) r)},{-0.26*0.966*sin(2*(\x-0.1) r)});
%
\foreach \x in{6.2,6.45,...,12}
\draw[color=red!50!black,->,>=stealth] (\x,0,0) -- (\x,{0.26*0.26*sin(2*(\x-0.5) r)},{0.966*0.26*sin(2*(\x-0.5) r)});
%
%Second polarization
%
\draw[fill=black!60!white, opacity=0.3] (12,-2,-1.5) -- (12,-2,1.5)node[above, sloped,midway]{Polaroid} -- (12,2,1.5) -- (12,2,-1.5) -- cycle;%Polarizing filter
%
\draw[thick,<->,>=stealth] (12,-1.5,-0.5) -- (12,-1.5,0.5);%Polarization direction
%
%Light leaving the second polaroid
%
\draw[thick,color=red!80!black,smooth,variable=\x,samples at={12,12.25,...,14}] plot (\x,{0},{0.966*0.966*0.26*sin(2*(\x-0.5) r)});%n'g polarized ray
%
\draw[thick,color=green!80!black,smooth,variable=\x,samples at={12,12.25,...,14}] plot (\x,{0},{-0.26*0.966*sin(2*(\x-0.1) r)});%n'p polarized ray
%
\end{tikzpicture}
\unnumberedcaption{Light behavior in a petrographic microscope with light polarizing device. %
Only one incident wavelength is shown (monochromatic light).%
 The magnetic field, perpendicular to the electric one, is not drawed.}
\label{fig:MicroPol}
\end{center}
\end{figure}

%@@@@@@@@@@%
\end{document}